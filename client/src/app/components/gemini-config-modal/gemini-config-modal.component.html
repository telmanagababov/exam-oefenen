<div class="modal-overlay" (mousedown)="onOverlayClick($event)">
  <div
    class="modal-dialog"
    role="dialog"
    aria-modal="true"
    aria-labelledby="config-modal-title"
  >
    <div class="modal-header">
      <h2 id="config-modal-title" class="modal-title">Gemini API Configuratie</h2>
      <button type="button" class="modal-close" aria-label="Sluiten" (click)="onClose()">√ó</button>
    </div>

    <div class="modal-body">
      @if (serverHasConfig()) {
        <div class="alert alert-info">
          <small>
            <strong>Info:</strong> De server heeft al een API-configuratie. Je kunt deze
            overschrijven met je eigen instellingen.
          </small>
        </div>
      }

      <div class="form-group">
        <label for="apiKey" class="form-label">
          Gemini API Key <span class="text-danger">*</span>
        </label>
        <div class="input-group">
          <input
            id="apiKey"
            [type]="showPassword() ? 'text' : 'password'"
            class="form-control"
            placeholder="AIza..."
            [(ngModel)]="apiKey"
            required
          />
          <button
            type="button"
            class="btn btn-outline-secondary"
            (click)="togglePasswordVisibility()"
            [attr.aria-label]="showPassword() ? 'Verberg API key' : 'Toon API key'"
          >
            {{ showPassword() ? 'üëÅÔ∏è' : 'üëÅÔ∏è‚Äçüó®Ô∏è' }}
          </button>
        </div>
        <small class="form-text text-muted">
          Verkrijg je API key op
          <a href="https://makersuite.google.com/app/apikey" target="_blank" rel="noopener">
            Google AI Studio
          </a>
        </small>
      </div>

      <div class="form-group">
        <label for="model" class="form-label">
          Model <span class="text-danger">*</span>
        </label>
        <select id="model" class="form-select" [(ngModel)]="model" required>
          @for (modelOption of availableModels; track modelOption) {
            <option [value]="modelOption">{{ modelOption }}</option>
          }
        </select>
      </div>

      <div class="form-check">
        <input
          id="remember"
          type="checkbox"
          class="form-check-input"
          [(ngModel)]="remember"
        />
        <label for="remember" class="form-check-label">
          Onthoud deze instellingen (opslaan in localStorage)
        </label>
      </div>
    </div>

    <div class="modal-actions">
      <button type="button" class="duo-button duo-button-secondary" (click)="onClose()">
        Annuleren
      </button>
      <button type="button" class="duo-button duo-button-primary" (click)="onSave()">
        Opslaan
      </button>
    </div>
  </div>
</div>
